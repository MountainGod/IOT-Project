<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<meta http-equiv="X-UA-Compatible" content="ie=edge"/>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link rel="stylesheet" href="/css/shared.css"/>

	<link rel="icon" type="image/x-icon" href="/img/logo.svg">
	<title>Cameras</title>
</head>
<body class="bg-dark text-white">

<!-- 	filled in with js on load. -->
<nav class="navbar sticky-top navbar-expand-md navbar-dark" id="navbarMain"></nav>

<div class="jumbo mb-3 text-center">
	<h1 class="display-1 text-info">
		Cameras
	</h1>
	<h2 class="h2 text-white">
		Click on a camera to access it. <br>
	</h2>
	<p class="p text-white">
		If you do not have a camera registered, click "Add" below.
	</p>
</div>

<div class="modal fade" id="addCamModal" tabindex="-1">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content bg-dark">
			<div class="modal-header">
				<h3 class="modal-title text-center">Add a camera</h3>
				<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
			</div>
			<form action="./" method="post">
				<div class="modal-body">
					<p>Enter the ID that came with your camera:</p>
					<div class="row form-floating text-black mx-1">
						<input type="text" class="form-control" id="camID" placeholder="Camera ID" name="camID" required/>
						<label for="camID">Camera ID</label>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-success" id="addCamBtn">Add</button>
				</div>
			</form>
		</div>
	</div>
</div>

<div class="modal fade" id="camModal" tabindex="-1">
	<div class="modal-dialog modal-fullscreen modal-dialog-centered">
		<div class="modal-content bg-dark">
			<div class="modal-header justify-content-center">
				<h3 class="modal-title" id="camModalTitle">camera </h3>
			</div>
			<div class="modal-body d-flex justify-content-center align-items-center p-0">
				<canvas class="align-self-center m-0" id="streamCanvas"></canvas>
			</div>
			<div class="modal-footer">
				<div class="container-fluid row">
					<span class="col-3"></span>
					<span class="col-3 text-end text-info">Result:</span>
					<span class="col-3 text-start text-info" id="resultText">Unknown</span>
					<span class="col-3"></span>
				</div>
				<div class="container-fluid row justify-content-between">
					<button type="button" id="startPredictBtn" class="col-3 btn btn-success">Start Testing</button>
					<button type="button" id="stopPredictBtn" class="col-3 btn btn-danger" hidden>Stop Testing</button>
					<button type="button" id="closeModalBtn" class="col-3 btn btn-secondary" data-bs-dismiss="modal">Close</button>
				</div>
			</div>
		</div>

	</div>
</div>

<div class="container" id="cameraSelectionContainer">
	<div class="row align-items-center" id="cameraSelectionRow">
		<div class="col-4">
			<div class="ratio ratio-1x1">
				<button type="button" class="btn btn-success rounded-circle fs-1 fw-bold"
				        data-bs-toggle="modal" data-bs-target="#addCamModal">
					Add
				</button>
			</div>
		</div>
	</div>
</div>

<div style="display: none" hidden>
	<img src="" id="camStream" class="col-auto w-100" alt="Camera live stream">
	<video autoplay playsinline webkit-playsinline id="videoStream"></video>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/js/bootstrap.bundle.min.js"></script>
<script src="/dist/navbar.bundle.js"></script>
<script src="/dist/shared.bundle.js"></script>
<script src="/dist/cameras.bundle.js"></script>
<script src="https://unpkg.com/@tensorflow/tfjs-core@2.4.0/dist/tf-core.js"></script>
<script src="https://unpkg.com/@tensorflow/tfjs-converter@2.4.0/dist/tf-converter.js"></script>
<script src="https://unpkg.com/@tensorflow/tfjs-backend-webgl@2.4.0/dist/tf-backend-webgl.js"></script>
<script src="https://unpkg.com/@tensorflow-models/face-landmarks-detection@0.0.1/dist/face-landmarks-detection.js"></script>
<script src="/js/faceLandmarks.js"></script>
</body>
</html>
